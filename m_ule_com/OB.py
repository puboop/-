import re

def dencrypt_code():
    '''输入的文件必须为压缩的js代码文件，不能进行格式化'''
    with open("fm_web.js", encoding="utf-8") as f:
        code = f.read()
    arr_big = eval(code.split(";}});}));}(")[1].replace("));})();", ""))
    name = re.search("typeof Symbol,(.*?)\[\d+\]", code).group(1)
    for i in arr_big:
        code = code.replace(f"{name}[{arr_big.index(i)}]", f'"{i}"')

    # 还原数字表达式
    def expr_eval(S):
        def su(num):
            # 取出匹配的字符
            num = num.group()
            # 计算并返回字符串类型
            return str(eval(num))

        # 会将整个匹配到的一起替换
        return re.sub("\d+\+\d+-\d+", su, S)

    expr = expr_eval(code)

    with open("red.js", "w", encoding="utf-8") as f:
        f.write(expr)

def encrypt():
    '''上那个不好使，使用这个，使用格式化后的代码，需要手动输入name的值，QOOQOQ[1329]'''
    array = ['zsHpIDELjthLGP7aMaeobfxizx', 'FLOAT', 'toLowerCase', 'divide', '04', 'precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}', 'pdf', 'webkitOfflineAudioContext', 'itsgonnafail', 'TeletexString', 'enableVertexAttribArray', 'encrypt', 'fakeHover', 'attack', 'replace', 'PasswordBasedCipher', '12', 'head', 'setString', 'setPublicKey', 'fpHost', 'enc', 'node collapsed', 'device_name', 'DERGeneralizedTime', 'fpflash.fraudmetrix.cn', 'createAnalyser', 'rGnj', 'CTR', 'ASN1Util', 'change', 'bigIntToMinTwosComplementsHex', 'malformed oid string: ', 'fromNumber', 'createDynamicsCompressor', 'chunkSize', 'WebOS', 'parseStringISO', 'dp', 'z1zjINELjGhLGP7A', 'MS PGothic', 'script', '$1\r\n', 'Offset: ', 'race', 'brand', 'functionget', 'jTimeout', 'OBJECT_IDENTIFIER', 'useSid', 'boolean', 'https', '1', ',', 'isSafari', 'callee', 'Segoe UI Semibold', '_keyPriorReset', 'multiplyUpperTo', 'gdph', 'typeName', 'alphabetic', 'D', 'subTo', 'application/gameplugin', 'zIzLanEeRLhwYO71eHUEb6xHhSHv', 'phantomjs', 'className', 'Calibri', 'hasContent', 'DERAbstractStructured', 'ipod', 'toRadix', 'toLocaleString', '$1', 'reCheckCookie', 'toLocaleLowerCase', '0.0.0.0', 'zPzjIKEkRLPIGZ7FeaCEJgxI', 'q3', '/v3/fm.js', '6', 'asn1Array', 'netscape', '18', 'data', 'toDataURL', 'equals', 'openDatabase', 'cookieEnabled', 'application/hwepass2001.installepass2001', 'Times New Roman', 'en-US', 'env', 'outro', 'InstallTrigger', 'hV', 'MSIE', 'generate', 'lqsJ', 'compileShader', 'queryUsageAndQuota', 'itemSize', 'pad', 'htHdaQwhjBhHGZ7W', 'dlen', 'call', 'encode', 'left', 'UniversalString', 'durations', 'MicroMessenger', 'linkProgram', 'crios', '7', 'taobao', 'subtract', 'zbHlaMEC', '_x64Add', 'getContext', 'reason', 'm', 'yrHe', 'FormData', 'N', 'BOOLEAN', '_ENC_XFORM_MODE', 'Image', 'drawImage', 'zNHQaIEGSLPwGq7AoHUJJdfj', 'expected', 'PRESTO', 'timeout', 'setDate', 'flipBit', '9', 'sessionStorage', 'reduce', 'FRAGMENT_SHADER', '-webkit-hyphens', 'zNHpaKOkjLhIGZ7AMNCc', 'hasOwnProperty', 'selected', 'documentMode', ',sub:', 'noIframe', 'Tahoma', 'parseTime', 'find', 'Mozilla', 'oyo', 'cfg', 'formatDate', 'STATIC_DRAW', '_prevBlock', '  ', 'h', 'onicecandidate', 'xor', '14px \'Arial\'', 'EOC', 'hex', '/web/ub.png', 'd', 'pxy', 'partnerDetectUrl', 'removeItem', ' bit)', 'valueOf', 'fmTest', 'DERAbstractString', 'flush', 'zRzLINEGRVrRYy7FeyUoJg', 'task', 'ZERO', 'Lucida Console', 'log', 'text-rendering', 'CSS', 'map', 'appendASN1Object', 'getKey', 'B', 'MSPointerEvent', 'Wingdings 3', 'hPHjIXEGjuhiHP7aMr', 'candidate', '_keySchedule', 'Chromium', '2d', 'rimtablet', 'G', 'modInt', '8', 'oid', 'zVzLaNELjKQFGPple4U5bE', 'mp', 'position', 'GeneralString', 'fp.fraudmetrix.cn:9090', 'divRemTo', 'Arial Hebrew', 'get', 'enumerable', 'mac os', 'firefox', 'success', 'type', ' @', 'j', 'fillText', 'MAC', ' is not a function', 'createOscillator', 'mt2', 'linux', 'bufferData', 'paramz', 'chargingTime', 'function(){[nativecode]}', 'zVzcaQELjCrRYy7FeyUoJg', 'TOUCHPAD', 'cssText', 'zczwaMwFRIhrGZqRezCpJdxNzRHChX', 'drShiftTo', 'gDDI', 'pBqF', 'isChrome', '*', 'parseOctetString', 'sine', '_fmOpt.partner is blank, please set the value of _fmOpt.partner and try again!', 'getPrivateKeyB64', 'base64s', 'DeviceMotionEvent', 'lib', 'Possible Unhandled Promise Rejection:', 'bin', 'Book Antiqua', 'CHROMEOS', 'EvpKDF', 'via', 'Netscape', 'webkitRTCPeerConnection', '/fp/detect.json', '_fmaa', 'compute', 'bigint', 'sort', 'catch', 'GM_addResource', 'base64_map', 'preview', '1234567812345678', 'parseBitString', 'air', 'signum', ' ', '` to object', 'zSHLIDELjIhriK7AeLUeJqfN', 'AES', 'knee', 'DERAbstractTime', 'extend failed, please check that ', 'hexNode', '-9999px', 'localStorage', 'BlockCipher', 'ua', 'Universal_', '@script', '__wxjs_environment', 'F2', '<br/>', '0', 'explicit', 'gcda', 'enabled', 'lzbH', 'createElement', '_TDfactor', 'outerHeight', 'parseStringBMP', 'utc', 'q', 'allSettled', 'BB26C2E91BA08EFB', 'zVzDIoO7jOhDYy', 'squareTo', 'rejected', 'k', 'SEQUENCE', 'p', 'RTCPeerConnection', 'tokens', 'Helvetica', 'OfflineAudioContext', 'TDpx', '#f60', '_xformMode', '/FreshCookieRequest/fresh.json', 'consoleCheck', 'DERTaggedObject', '06', '03', 'td_ua', 'i init ok', 'node', 'getFloatFrequencyData', 'unpad', '[object Function]', 'fromCharCode', 'RIMTABLET', 'availHeight', 'TEMPORARY', 'MS Outlook', 'status', 'extend', '05', 'innerWidth', 'int', 'getFreshValueHex', 'CipherParams', '@', 'zRzjaKw8Ru', 'WINNDOWS', 'zNHpanwGjBhLYMpbMzCpbFft', 'caja', 'frameElement', 'Segoe Print', 'hSHQaIEGREhHYp7A', 'webkitRequestFileSystem', 'getLowestSetBit', 'DERUTF8String', 'pjlF', 'multiplyTo', '\\', '\'WebSocket\' is undefined', 'msie', 'zPHpanwXjOPFHP7aoQUiJgxmi10wkExeRLPSY371ey', 'push', 'removeChild', 'Arial Narrow', 'gcd', 'Alipay', 'gen', 'true', 'x-nacl', 's38huiupo1g', ',v=', 'src', 'parseInteger', 'Safari', 'remove', 'h0HQaNwhjU', 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_', 'rShiftTo', 'DV', 'vDHC', 'function()', 'dmp1', '})', 'y', 'substr', 'Cambria Math', 'charAt', 'Constructor', 'zVzDIoOejKhIYyH1eTUabF', 'Trident', 'toGMTString', 'splice', 'bada', 'zsHpINELRBhriG7AeqUDJgxs', 'warn', 'msg', 'collectBehavior', '-----\r\n', 'Latin1', 'webgl-fingerprint-defender', '_phantom', 'chrome', 'z1HCIwEctLhrGF7FeNUEJd', 'Length over 24 bits not supported at position ', 'ubid', 'onmouseout', 'Lucida Sans', 'z6HCanEGRVQqY37bMQUo', 'showModalDialog', 'Arial', 'default_key_size', 'unused bits shall be from 0 to 7: u = ', 'outerHTML', 'suffixes', 'WebView', 'iframe', 'charCodeAt', 'tao', 'blackberry', 'posContent', 'uniform2f', 'INTEGER', 'ENUMERATED', 'tdfp', 'RGBA', 'zPHda1EGjlPIi37b', 'fromString', 'appName', 'not a function', 'numItems', 'getElementsByTagName', 'getImageData', '__defineGetter__', 'toPrettyString', 'getLengthHexFromValue', 'IOS', 'offsetUniform', 'false', 'zczwaMwFRIhrGZqbM4C6bF4t', '&', 'floor', 'window', 'SyntaxError', 'getElementById', 'chromeos', '9LzjkIEhqu', 'Array.prototype.indexOf() - can\'t convert `', '\n', 'match', 'wordwrap', 'BLACKBERRY', 'Select * from Win32_NetworkAdapterConfiguration Where IPEnabled =True', 'bot', 'yangcong', 'maxTouchPoints', 'getPublicBaseKey', 'RegExp', 'i.html', 'REAL', 'h0HLaXEFjCQHYK7blz', ')', 'BMPString', 'cookieHandler', 'gFlu', 'sqrTo', 'referer', 'g', 'title', ' byte) ', 'Firefox', 'newValue', 'findIndex', 'createShader', 'BADA', '_xid', 'DERObjectIdentifier oidName undefined: ', 'ldDF', 'F', 'clearBit', 'screenX', '= \f\n\r\t\xA0\u2028\u2029', 'GraphicString', '; expires=Thu, 01-Jan-70 00:00:01 GMT;', 'LUCIDA GRANDE', 'VisibleString', 'dlShiftTo', '', 'FfhJ', 'tzso', 'msMaxTouchPoints', 'IPOD', '<br/>(constructed)', '0123456789', 'outerWidth', 'rtcFinished', 'onRejected', 'drawArrays', 'en-US,en', 'zxHLIXE7juh9HF7AMaCcbKxizsOw', 'position:absolute !important; z-index:-9999 !important; visibility:hidden !important;border:0 !important', 'OCTET_STRING', 'btmz', 'https://fp.fraudmetrix.cn', 'canvas-fingerprint-defender-alert', 'J', 'Microsoft Sans Serif', 'Malformed UTF-8 data', 'createProgram', 'open', '_x64LeftShift', 'U', 'TRIDENT', 'Webkit', 'url', 'start', '0123456789abcdefghijklmnopqrstuvwxyz', '&h=', 'zSHlknEgRLQIGZ7eeNUA', 'Browser Plug', 'ongestureend', 'count', 'Edg/', 'shaderSource', 'b', 'Cambria', '&appName=', 'setByBinaryString', 'L', 'a0', 'enumerateDevices', 'ios', 'requestPermission', 'token_id', 'zSHLaXwGjthqYyplNaUEbjfgzRHC', 'userData', 'hPHjIXEGjuhiiG7AeGCf', '/', 'x', 'iceServers', 'String', 'o', 'X', 'MYRIAD', 'all', 'IPHONE', 'init', 'jyru', 'complete', 'SET', 'Monaco', 'content', 'experimental-webgl', 'Arial Black', 'Times New Roman PS', 'Length: ', 'onload', 'IE', 'Lucida Handwriting', 'zbHpIXEhRthLGZ7AoNUeb6xgh1zwIXEGjlhFG3', '_t41', 'hPHjIXEGjuhiiY7aePUA', 'https://fptest.fraudmetrix.cn/partnerProfile.json', '[header:', 'WEBKIT', 'htHdaQwhjBhHGZ7WNGUEJqfgz6Hlan', 'hSHlIwEejUQFGyp2MrUeJqfj', '_unhandledRejectionFn', '360EE', 'isBlink', '_DEC_XFORM_MODE', 'device_type', 'createOffer', 'stream', '00000000', 'Cipher', 'zPHda1EGjlPIHx7FeQCfbp', '_value', 'add', 'zding_', 'hostname', 'zSHLaXwGjtQIYO7aeH', 'zumk', 'zJHlaKEkRLhwYO71', 'fontFamily', 'onreadystatechange', 'channelInterpretation', 'static.fraudmetrix.cn', 'gFxu', 'HTMLElement', 'sandbox', 'e', 'min', 'zVzDIoOcjzhiYOplNGUEJqfgz6Hlan', '_data', 'JSON', 'allow-scripts', 'parseKey', 'write', '_sz', 'dmq1', 'every', 'configurable', 'getHighEntropyValues', 'getMonth', 'micromessage', 'DERIA5String', 'readyState', 'toHexString', 'Base64', 'application/', 'zJHpanEFRuhLYx7A', 'WEBGL_debug_renderer_info', 'cqhk', 'rhino', '_keyStr', 'rgba(102, 204, 0, 0.7)', 'EMBEDDED_PDV', 'trident', 'onmessage', 'div', 'appendChild', 'S', 'array', '[', 'name', 'getSeconds', ' is not iterable(cannot read property Symbol(Symbol.iterator))', 'isExplicit', 'Monotype Corsiva', 'parseOID', 'Impact', 'stack', 'numberOfInputs', 'ASN.1 length too long to represent by 8x: n = ', 'value hex must be even length: n=', '&productType=2', '_', 'SAFARI', 'obj', 'stringify', 'fillStyle', 'tokenId', 'mozRTCPeerConnection', '5', '/web3_8/profile.json', 'multiply', 'hasher', 'c', '&browser=', 'Uburl', 'doPublic', 'zJHpanEFRuhLYx7AMN', '_nRounds', 'reverse', 'https://fptest.fraudmetrix.cn/partnerDetect.json', 'imgLoaded', 'mimeTypes', 'offsetWidth', 'toHexDOM', 'keyWords', 'zPHpanwXjOPFHq7FMZUEbX', 'Ijcz', 'Y', 'parse', 'NumericString', 'abs', 'Q', 'this is null or not defined', 'Chrome', '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz', 'reSeemsASCII', 'platformVersion', 'userAgent:', 'SILK', 'finally', 'isIE', 'Segoe UI Light', 'attachEvent', 'x-pnacl', 'Andale Mono', 'posEnd', 'doPrivate', 'Application_', 'textBaseline', 'words', '(.{1,', 'functiontoString(){[nativecode]}', 'fullVersionList', 'WINDOWSPHONE', '0c', '&sdkName=cn.tongdun.web', 'CbGz', '|', 'zcHpINwhjuPSG3', 'Segoe UI Symbol', 'CBC', 'isPrototypeOf', '_reverseMap', 'Hmqb', 'aomygod', 'vertexAttribPointer', 'convert', 'zqoF', 'Century', 'PointerEvent', 'zPHpanwXjOPF', 'StreamCipher', '20030107', 'toDOM', '-&-', ' UTC', 'webos', '4enw49pim03', 'facebookexternalhit', 'fromRadix', 'intValue', 'Z', '_x64Xor', 'getBattery', 'zeroPadding', 'http://fp.fraudmetrix.cn', 'description', 'zNHpaEELjIhwYOpAMNecJqfs', 'A', '_deferreds', 'jsDownloadedTime', 'BlockCipherMode', 'screen', 'normal', 'RegExp out of sync', '_hash', ' elem)', 'resize', 're', 'contentWindow', 'ucapi', 'divideAndRemainder', 'channelCount', 'invDigit', 'MSIE ([0-9]{1,}[.0-9]{0,})', 'id', '31', 'setValueName', 'z6HCaKEgjthiY3pbePDpbFxmhPHlan', 'BqAH', 'kdf', 'null', 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/', 'style', 'application/360softmgrplugin', 'setStringHex', 'Base', 'languages', 'writable', 'setBit', 'GECKO', 'detachEvent', 'text-align-last', 'LN2', 'font-fingerprint-defender', 'f736mgcni9c', 'zPHlaMECjzhriy71eTUpbXxIzS', 'hasPublicKeyProperty', 'R', 'asn1', 'cookieStore', 'clamp', 'Shockwave Flash', 'saveData', 'key', 'result', 'F1', 'E', 'index', 'referrer', 'forEach', 'htHdIwEFjzhiGMqYMQCpbKx9z0', '3', '_callback=', 'I', '-----BEGIN ', 'disconnect', 'Promise.race accepts an array', 'next', '__BROWSERTOOLS_DOMEXPLORER_ADDED', 'l', 'DOLFIN', 'keys', 'getOwnPropertyDescriptor', ' (constructed)', 'tDkG', 'setByBooleanArray', 'defineProperty', 'Android.*(wv|.0.0.0)', 'WbemScripting.SWbemLocator', 'toHexDOM_sub', 'CHROME', 'revert', 'initCookie', 'tIndex', 'fpNetHost', 'hJFw', 'MD5', '_TDopnum', 'productSub', 'Hex encoding incomplete: 4 bits missing', 'mulTo', 'htHdIwEFjzhiGM', 'getString', ' \f\n\r\t\xA0\u2028\u2029', 'addTo', 'cacheKeyBlackboxTimestamp', 'IbdE', 'A promise cannot be resolved with itself.', 'In test[', 'wm', 'documentElement', 'toUpperCase', 'battery', 'modPowInt', 'webkit', 'name2oidList', 'intro', 'removeHandler', 'h0HLaXEFjCQFGPple4U5bE', 'DERBoolean', 'join', 'MOZILLA', 'bbBB', 'z1HCIwEcjuPSYSpbezefbFfZz6HjawweSIPIGZ7FeqUD', 'EXTERNAL', 'Hex', 'setByInteger', 'function', 'Math', 'concat', 'fulfilled', 'DERInteger', 'attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}', 'common2345', 'mousemove', 'indexOf', 'DB', 'r', '_IEEnumFix', 'Android', 't', 'a', 'isEdge', 'characterSet', 'lineHeight', 'resolve', '4', 'asn1Object', '8.0', 'webkitTemporaryStorage', 'getFullYear', 'mozilla', 'MYRIAD PRO', '17', 'Win32', '; path=/', 'now', 'compatible', 'touchpad', 'sigBytes', 'webgl-fingerprint-defender-alert', 'dec', 'zVzLaNELjKrFYO71MQUEJpfj', '__IE_DEVTOOLBAR_CONSOLE_COMMAND_LINE', 'Object', '__proto__', 'sub', 'frequencyBinCount', '<br/>(encapsulates)', ';', 'startRendering', 'all dependencies are included.', 'filename', 'Console', 'Edge', 'DEROctetString', 'app_name', 'width', 'zoom', 'userAgentData', 'unable to locate global object', 'V', 'getEncodedHex', 'hPzDawEejzhLYG7lMaUeJEfgz1zw', 'setHexValueIncludingUnusedBits', 'OID', '})( +|$\n?)|(.{1,', 'cookie', 'shortValue', 'opr', 'shiftLeft', 'message', 'edit', 'DERObjectIdentifier', 'destination', 'adblock2345', 'TAOBAO', 'firstChild', 'android', 'bitLength', 'remainder', 'insertBefore', 'spider', 'detectSwitch', 'PZRGhxx7XSY4ci+5tBEpoaIPzrxBRUSf2D1mB3Es29EE6Qe7+7CyweCLE6vqen24', 'z0HLINOFRmPr', 'isArray', 'channelCountMode', '_handled', 'Imnb', 'UNSIGNED_BYTE', 'MS Serif', 'zSHLIDELjIhrHq7FMZUEbXgtzVzma1Eg', 'setMonth', 'hash128', 'coeff', 'cFcj', 'ct', 'random', 'M', 'Arial Rounded MT Bold', 'z', 'K', 'xdid', '_fmBehaviorBlackbox', 'Utf8', 'gecko', 'reject', 'platform', 'propertyIsEnumerable', 'unarmor', 'hbRmawwXjzhFYyHFeQ', 'hczmaKxeRLPSY371ey', 'FV', '360SE', 'serif', 'MSIE (\\d+\\.\\d+);', 'detect', 'exp', '未定义', 'or', 'Exception while decoding undefined length content: ', 'millerRabin', '; domain=', 'screenY', 'Content size is not correct for container starting at offset ', 'location', 'ub', 'miniprogram', 'isEven', 'Lucida Fax', 'createEvent', 'zSHLaXwGjtQIY37Wez', 'behaviorUrl', 'reduction', 'hPzQIKwhjuhDiG7eeqUDJFxmz0HL', 'charset', 'setItem', '&browserVersion=', 'Lucida Sans Typewriter', 'plugins', 'shift', 'Times', '0123456789ABCDEF', 'ONE', 'Garamond', 'pushNotification', '; expires=', '0500', 'removeEventListener', '\u2026', 'indexedDB', '(', 'DM', 'xxid', 'fillRect', 'isGecko', 'xiamenair', 'browser', '~/=', 'pvft', 'gesture', 'RequestFileSystem', 'jsonFreshUrl', 'getCookie', 'slice', 'getElementsByName', 'ExecQuery', 'Date', '16', 'application/mozilla-npqihooquicklogin', 'mmmmmmmmmmlli', 'usageDetails', 'string', 'mpl', 'getUniformLocation', 'isFirefox', 'language', 'BIT_STRING', 'date', 'initStorage', 'Palatino', 'gnpp', 'zNzjkIEkRUQIYOpAeNUoK7xiz6HCINwe', 'changeBit', 'ufHI', '<br/>(warning!)', 'GeneralizedTime', 'parseStringUTF', 'screenTop', 'Lucida Sans Unicode', 'integerToByteHex', '2345Explorer', 'attrVertex', '_k41', 'x509', 'top', 'LIEBAO', 'iterator', 'mod', 'setLocalDescription', 'isOpera', 'decodeLength', 'sampleRate', 'Bookman Old Style', 'CICy', 'bindBuffer', 'ASN1Object', ' OPR/', 'Courier New', 'cacheKeyBlackbox', '_minBufferSize', 'Century Gothic', '_x64Fmix', 'Hasher', 'estimate', 'WordArray', 'str', 'ABCDEFGHJIKLMNOPQRSTUVWXYZ', 'zIHlanwhRIr9Y3pYMQ', '_Selenium_IDE_Recorder', '</b>', 'page:', '_ks', 'w', 'Segoe Script', ':', 'o8gm8qu97as', 'localDateToUTC', 'blackBoxType', 'onerror', 'isProbablePrime', ' (undefined)', 'audiocontext-fingerprint-defender', 'connect', 'Wingdings', 'IA5String', 'HTMLScriptElement', 'tcpHost', '$super', '0123456789abcdef', 'partner', 'https://static.tongdun.net/v3/3_8', ' on a stream of length ', 'mfsG', 'DERNumericString', 'StyleMedia', 'innerHeight', 'nextBytes', 'rtcAvailable', 'getParameter', 'ratio', '&errorMsg=', 'Promises must be constructed via new', 'onsuccess', 'lShiftTo', '?platform=3', '=; domain=', 'Century Schoolbook', 'MS Sans Serif', 'text', 'toByteArray', 'zBmz', 'UTF8String', '(){[nativecode]}', 'major', 'win', 'tag', 'zPHvaQwrRIhrGP', 'ARRAY_BUFFER', 'reliable', 'getinfo', 'quota', 'onFulfilled', 'Geneva', 'webkitAudioContext', 'getItem', 'ie', 'WEBOS', '_fmOpt', 'um', 'z6HCanEGRVrRYy7FeyUoJg', '_k16', 'zVzcaQELjCQqY37bMQUo', 'ghijklmnopqrstuv', '_fmdata', 'audiocontext-fingerprint-defender-alert', 'eruda', 'ActiveXObject', 'ECvA', 'webkitBattery', 'level', 'attachShader', 'header', 'T', 'ulen', 'check', 'createBuffer', 'Hxuw', '_x64Multiply', 'length', 'ConnectServer', 'hSHQaIEGRIPIYS7WMr', 'DERBitString', 'iterations', 'timestamp', 'can\'t find _fmOpt', 'zPzDIwOejChLGMpY', '.', 'font-fingerprint-defender-alert', 'BufferedBlockAlgorithm', 'presto', 'iphone', 'copyTo', 'set', 'ANDROID', 'z1zmaWOLRm', 'HMAC', 'default_public_exponent', 'reTime', 'setKey', 'Object.keys called on non-object', 'getHours', 'r2', 'Mac OS', '_nDataBytes', 'Courier', 'setValueHex', 'algo', 'application/vnd.chromium.remoting-viewer', 'TrackEvent', 'print', 'macintosh', 'then', 'isUC', 'f', 'superclass', '0101ff', 'storage', 'bitwiseTo', 'and', 'apply', 'loaded', 'vertexPosAttrib', 'crypto', 'toString', 'functionlog(){[nativecode]}', 'addons', 'parsePropertiesFrom', 'jsonUrl', 'AudioContext', '&errorType=', 'secure', 'this.hV is null or undefined.', '02', 'UTC', 'DERPrintableString', 'DERSet', 'onclick', '&os=', 'canvas', 'staticHost', 'compareTo', '30', 'keywords', 'TRIANGLE_STRIP', 'offsetHeight', 'test', 'no token returned', 'zPHvawEejqPqY371eQUeJE', 'unload', 'setByBigInteger', 'bitCount', 'v', 'isModified', 'connection', 'u', 'Microsoft Internet Explorer', 'hexDump', 'Lucida Bright', 'detectEthernet', 'windows', 'constructor', 'callPhantom', 'MACAddress', '/web3_7/profile.json', 'PrintableString', 'device-version', 'NULL', '&osVersion=', 'Helvetica Neue', 'createTextNode', 'zPHda1EGjlPIiY7Ae4UDbpfj', '_invKeySchedule', 'console', 'phantomas', 'rv:11.0', 'ceil', 'kernelVersion2', 'getTime', 'wr', 'zPHpanwXjOPFiy7WMrCfJKgjzRRmaQwhjOQrHZHS', 'zxHLIXE7juh9iFplePUaldxaz6HLanwh', 'ig', 'wsHost', 'iePrivacy', 'Bitstream Vera Sans Mono', 'number', 'canSetSearchEngine', 'hexDigits', 'abcdefghjiklmnopqrstuvwxyz', 'h1zjawwrtOhqYy71MQ', '_immediateFn', 'fakeOut', 'setByDateValue', 'andNot', 'orientation', 'msBattery', 'Base64 encoding incomplete: at least 2 bits missing', 'Lucida Calligraphy', 'setByASN1ObjectArray', 'onunload', '\r\n-----END ', 'lcvh', '(iPhone|iPod|iPad)(?!.*Safari/)', 'debug', 'promise', 'private', 'testBit', 'readPixels', 'getDate', 'Comic Sans', '__nightmare', 'Opera', 'numberOfOutputs', 'h1zjawwrtChLYp79MzUibExI', 'factor', 'posStart', 'parseUA', '00', 'charging', '_cipher', 'hexCurrent', 'zbHLaQEhjChrGMpYNaUEbjfgzRHC', '010001', 'from', 'eEBd', '_selenium', 'zbHLa1EFjUPI', 'caller', 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCuR3+MuPOVYuAKOS6O+J/ds+JAesgyFforFupDiDBBMTItdXyMrG6gUPFxj/pT/9uQSq8Zxl7BrdiKdi0G2ppEn4Nym+VRLTv2+lNa3kvlrj25Lop7wDZkVRecK5oDvdaQHrm4KKiF7jZNbHEreWGsINLpGvzBMRNztRtOJ6+XEQIDAQAB', 'span', '] expected ', 'Arial Unicode MS', 'threshold', 'addres', 'Trebuchet MS', 'device_version', 'undefined', 'OPERA', 'appVersion,language,languages,mimeTypes,oscpu,platform,plugins,userAgent', 'getRandomValues', 'oncomplete', 'CrOS', 'postMessage', 'uc', 'navigator', 'vertexPosArray', 'mobile', 'partnerSendSwitch', ', ', 'multiplyLowerTo', 'generateAsync', 'mozBattery', 'fontSize', 'format', 'error', 'hyhbgqbaxi6', 'prlt87lwxvm', 'innerHTML', 'TouchEvent', 'z1HdawEcjuhiGPqYMQCpbKx9z0', '_mode', 'browserVersion2', 'iPhone', '_state', 'O', '-', 'getPEMStringFromHex', 'sin', 'op', 'https://xx.com', 'gk', 'pTimeout', 'n', ',length:', 'idf', 'setASN1Object', 'values', '^^', '_t16', 'screenLeft', 'clone', 'H', 'tdIframe', 'release', 'dMultiply', 'height', 'timer', 'abcdefghigklmn', 'zczwaMwFRIhrGZHSeTU5bEfIzVHKaw', 'Consolas', 'Arial MT', 'standalone', '&lt;', 'addEventListener', ']', 'alipay', 'modInverse', 'pos', 'Promise.all accepts an array', 'hTLV', ' hover', 'uniformOffset', 'prototype', 'onmouseover', 'wk', 'addHandler', '&sdkVersion=', '2.3.1', 'ch', 'ipad', 'partnerFpUrl', 'mu', 'UCNewsJSController', '+', 'ltx71', 'i', 'getExtension', 'enDe', 'useProgram', '_utf8_encode', '1234567890', 'SerializableCipher', 'Promise', 'getValueHex', ' (encapsulates)', 's', '01', 'getAttribLocation', 'webdriver', 'VideotexString', 'pageInfo', '13', 'getMinutes', 'onmousemove', 'monospace', 'application/asx', 'Illegal character at offset ', 'hSHlJKwhRVhwYp79NNCfJqxNzsHK', 'mac', 'maxChannelCount', 'Wingdings 2', 'desktop', 'w3', 'invoked', 'symbol', 'writeln', 'UNMASKED_VENDOR_WEBGL', 'square', 'Pkcs7', 'split', 'dischargingTime', 'https://bugly.tongdun.net/bugly/errorCollect/v1.png', 'hexByte', 'h77umrlknir', 'MS Reference Sans Serif', 'am', 'hPzQanwhjOPRiyplMaUeJq', 'getError', '72px', 'callSelenium', 'webgl', 'version', 'getTimezoneOffset', '&occurTime=', 'W', '79F05CA5AF1CAE77', 'Decryptor', 'cajaVersion', 'Segoe UI', '_key', 'q652mrpq0k', 'UTCTime', 'iUrl', 'fromInt', 'decode', 'decrypt', 'zVzDIoxXjuPSGM7FePU5', 'getPrivateBaseKeyB64', 'setByDate', 'DERTeletexString', 'font', 'amap', 'deviceInfo', 'object', '?', 'Private_', 'partnerCode', 'browserType2', 'FIqG', 'not', 'Palatino Linotype', 'getPrivateBaseKey', 'LINUX', 'blackBox', 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789', '2', 'negate', 'functionget(){[nativecode]}', 'fl', '_counter', '[object Object]', 'byteValue', '14', 'sans-serif', 'detectUrl', 'BfJy', 'exec', '_utf8_decode', '=', 'reuy', 'DERUTCTime', 'isWebkit', 'opera', 'ObjectDescriptor', 'zRzLINEGRVQqY37bMQUo', 'OpenSSL', 'absolute', '#069', 'kjxz', 'value', '[object SafariRemoteNotification]', 'Apple', 'VConsole', 'Unrecognized time: ', 'salt', '(Windows NT 10.0; Win64; x64', 'pow', 'zVzLaNELjKQSY3p2MrUWbF', 'https://fp.tongdun.net', 'Comic Sans MS', '_x64Rotl', 'availWidth', 'unknown', 'initialized', 'bingpreview', 'Georgia', 'IPAD', 'fmData', 'href', '<br/>Value:<br/><b>', '"function() {\\n      if (script.dataset.active === \'true\') {\\n        try {\\n          this.manipulate();\\n        }\\n        catch(e) {\\n          console.warn(\'manipulation failed\', e);\\n        }\\n      }\\n      return toDataURL.apply(this, arguments);\\n    }"', 'token', 'UC', 'createDataChannel', 'VERTEX_SHADER', 'newFalseArray', 'mediaDevices', 'max', 'MS Gothic', 'fromNumberAsync', 'x-google-chrome-pdf', 'checkStatus', 'setValueOidString', 'document', 'cdu', 'UNMASKED_RENDERER_WEBGL', 'modPow', 'DERNull', 'hL', 'Verdana', '_TDctimestamp', 'Requesting byte offset ', 'substring', 'setUnusedBitsAndHexValue', 'on', 'hT', 'dAddOffset', '__creator', 'DERSequence', 'ethernet', 'shiftRight', 'body', 'decryptBlock', '~/', ' got ', 'P', 'Gecko', 'safari', 'userAgent', 'os', 'isFunction', 'getHexStringValue', 'dingtalk', 'deleted', 'mph', 'HmacMD5', 'usage', 'C', 'rgba(255,255,255,1)', 'host', 'vendor', '1.2.840.113549.1.1.1', 'item']
    name = "QOOQOQ"
    with open("fm_web.js", encoding="utf-8") as f:
        code = f.read()
    for i in array:
        code = code.replace(f"{name}[{array.index(i)}]", f'"{i}"')

    # 还原数字表达式
    def expr_eval(S):
        def su(num):
            # 取出匹配的字符
            num = num.group()
            # 计算并返回字符串类型
            return str(eval(num))

        # 会将整个匹配到的一起替换
        return re.sub("\d+\s\+\s\d+\s-\s\d+", su, S)

    expr = expr_eval(code)

    with open("red.js", "w", encoding="utf-8") as f:
        f.write(expr)

encrypt()
